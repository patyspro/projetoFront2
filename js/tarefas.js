let body=document.querySelector("body"),toggle=document.querySelector("#toggle");toggle.addEventListener("click",function(){body.classList.toggle("dark")});const todoInput=document.querySelector(".todo-input"),dataInput=document.querySelector(".date-input"),todoButton=document.querySelector(".todo-button"),todoList=document.querySelector(".todo-list"),filterOption=document.querySelector(".filter-todo");let date=new Date;date.toLocaleString("pt-BR",{timeZone:"America/Sao_Paulo"});let dia=date.getDate(),mes=1+date.getMonth(),ano=date.getFullYear(),data_atual;10<=mes?data_atual=ano+"-"+mes+"-"+dia:mes="0"+mes,data_atual=ano+"-"+mes+"-"+dia,console.log(data_atual),dataInput.value=data_atual,dataInput.min=data_atual;var display_date=document.getElementById("display-date");display_date.innerHTML=dia+"/"+mes+"/"+ano,window.addEventListener("DOMContentLoaded",getTodos),todoButton.addEventListener("click",addTodo),todoList.addEventListener("click",deleteCheck),filterOption.addEventListener("click",filterTodo);let datalimite;function dataValidator(e,a){if(a){var a=e.slice(0,2),o=e.slice(3,5),d=e.slice(6);let t;return t=d>ano||(o>mes&&d>=ano||a>=dia&&o>=mes&&d>=ano),t}{o=e.slice(0,4),d=e.slice(5,7),e=e.slice(8);let t;return t=o>ano||(d>mes&&o>=ano||e>=dia&&d>=mes&&o>=ano),t&&(datalimite=e+"-"+d+"-"+o),t}}function addTodo(t){if(t.preventDefault(),console.log(dataInput.value),0!=todoInput.value&&10<=todoInput.value.length&&dataValidator(dataInput.value)){var e=Math.random(),t={id:e,tarefa:todoInput.value,data:datalimite,completed:!1};const a=document.createElement("li");a.setAttribute("id",e),a.classList.add("todo-item"),saveLocalTodos(t);const o=document.createElement("img");o.src="./assets/relozo.png",o.classList.add("icon-task");const d=document.createElement("div");d.classList.add("divInfo");const n=document.createElement("div");n.classList.add("descricao");const s=document.createElement("div");s.classList.add("containerData");const l=document.createElement("p");l.classList.add("texto"),l.innerText=todoInput.value;const i=document.createElement("p");i.innerText="Data limite :";const c=document.createElement("p");c.innerText=datalimite,c.setAttribute("class","conteudo-data"),a.appendChild(o),d.appendChild(l),d.appendChild(s),s.appendChild(i),s.appendChild(c),n.appendChild(d),a.appendChild(n);const m=document.createElement("div");m.classList.add("divButtons"),n.appendChild(m);const r=document.createElement("img");r.src="./assets/check-mark-8-32.png",r.classList.add("complete-btn"),m.appendChild(r);const u=document.createElement("img");u.src="./assets/x-mark-5-32.png",u.classList.add("trash-btn"),m.appendChild(u),todoList.appendChild(a),todoInput.value=""}else(todoInput.value=todoInput.value.length<10&&!dataValidator(dataInput.value))?alert("Digita uma tarefa com no mínimo 10 caracteres e escolha uma data limite no dia atual/no futuro"):dataValidator(dataInput.value)?alert("Digite uma tarefa válida com no mínimo 10 caracteres"):alert("Escolha uma data que esteja no dia de hoje ou no futuro"),todoInput.value=""}function deleteCheck(t){item=t.target;let e;if("trash-btn"===item.classList[0]&&confirm("Tem certeza que deseja excluir essa tarefa?")){for(;!item.parentElement.classList.contains("todo-item");)item=item.parentElement;item.parentElement.classList.contains("todo-item")&&(item=item.parentElement),e=item,e.classList.add("fall"),removeLocalTodos(e),e.addEventListener("transitionend",function(){e.remove()})}let a=JSON.parse(localStorage.getItem("todos"));if("complete-btn"===item.classList[0]){for(;!item.parentElement.classList.contains("todo-item");)item=item.parentElement;item.parentElement.classList.contains("todo-item")&&(item=item.parentElement),e=item,e.classList.toggle("completed"),e.classList.contains("completed")?e.classList.contains("completed")&&a.forEach(function(t){t.id==e.id&&(t.completed=!0)}):a.forEach(function(t){t.id==e.id&&(t.completed=!1)}),localStorage.setItem("todos",JSON.stringify(a))}}function filterTodo(a){let t=todoList.childNodes;console.log(t),t.forEach(function(t,e){if(console.log(t),0!=e)switch(a.target.value){case"all":t.style.display="flex";break;case"completed":t.classList.contains("completed")?t.style.display="flex":t.style.display="none";break;case"uncompleted":t.classList.contains("completed")?t.style.display="none":t.style.display="flex"}})}function saveLocalTodos(t){let e;e=null===localStorage.getItem("todos")?[]:JSON.parse(localStorage.getItem("todos")),e.push(t),localStorage.setItem("todos",JSON.stringify(e))}function getTodos(){let t;t=null===localStorage.getItem("todos")?[]:JSON.parse(localStorage.getItem("todos")),t.forEach(function(t){const e=document.createElement("img");e.src="assets/relozo.png",e.classList.add("icon-task");const a=document.createElement("li");a.setAttribute("id",t.id),a.classList.add("todo-item"),t.completed&&a.classList.add("completed");const o=document.createElement("div");o.classList.add("divInfo");const d=document.createElement("div");d.classList.add("descricao");const n=document.createElement("div");n.classList.add("containerData");const s=document.createElement("p");s.classList.add("texto"),s.innerText=t.tarefa;const l=document.createElement("p");l.innerText="Data limite :";const i=document.createElement("p");i.innerText=t.data,i.setAttribute("class","conteudo-data"),a.appendChild(e),o.appendChild(s),o.appendChild(n),n.appendChild(l),n.appendChild(i),d.appendChild(o),a.appendChild(d);const c=document.createElement("div");c.classList.add("divButtons"),d.appendChild(c);const m=document.createElement("img");if(m.src="./assets/check-mark-8-32.png",m.classList.add("complete-btn"),!dataValidator(t.data,!0)&&!t.completed){e.src="assets/relozovermelho.png",m.classList.add("expired");let t=document.createElement("p");t.setAttribute("class","textoLimite"),t.innerText="A data limite foi atingida!",n.appendChild(t)}c.appendChild(m);const r=document.createElement("img");r.src="./assets/x-mark-5-32.png",r.classList.add("trash-btn"),c.appendChild(r),todoList.appendChild(a)})}function removeLocalTodos(t){let e;e=null===localStorage.getItem("todos")?[]:JSON.parse(localStorage.getItem("todos"));t=t.children[0].innerText;e.splice(e.indexOf(t),1),localStorage.setItem("todos",JSON.stringify(e))}